---
jupytext:
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

````{admonition} Announcements & Reminders
:class: note
:class: dropdown



````


# üìñ Multivariate differential calculus (part 2)

<small>‚è± <span class="eta"></span> | <span class="words"></span> words</small>


````{dropdown} Sources and reading guide

```{figure} _static/img/bibliography/shsc2016.png
:width: 100px
:align: left
```
{cite:ps}`sydsaeter2016`

Chapters 11 and 12 (pp. 407-494).

<div style="clear: both"></div>

Introductory level references:
- {cite:ps}`bradley2008`: Chapter 7, Sections 1 to 3 (pp. 360-408).
- {cite:ps}`haeussler1987`: Chapter 17, Sections 1 to 7 and Sections 9 to 10 (pp. 668-706 and 714-723).
- {cite:ps}`shannon1995`: Chapter 10, Sections 1 to 6 (pp. 450-489).

Intermediate mathematical economics textbooks:
- {cite:ps}`chiang1984`: Chapters 6-8 and Chapter 10 (pp. 127-227 and 268-306).
- {cite:ps}`chiang2005`: Chapters 6 to 10 (pp. 124-290).
- {cite:ps}`simon1994`: Chapters 2 to 5 (pp. 10-103).

Mathematics textbooks:
- {cite:ps}`spiegel1981a`: Chapters 4, 6, 7 and 8; pp. 57-79 and 101-179.
- {cite:ps}`spiegel1981b`: Chapters 3 and 4; pp. 35-81.
````

> We want to extend our discussion of differential calculus from single-real-valued univariate functions, $f(x_1)$, to single-real-valued multivariate functions, $f(x_1,x_2,\dots,x_n)$.
> 
> We will be focussing on two concepts. These are **partial derivatives** and **total  derivatives**.


## Level curves



## Implicit functions

Until now we have been working with explicit functions where the dependet variable, $y$, is on the left side of the equation and the independet variables, $x_i$, are on the right side

$$
y = f(x_1,x_2,\dots,x_n).
$$

Frequently, we have to work with implicit functions where the dependent variable cannot be separated from the independent variables

$$
G(x_1,x_2,\dots,x_n,y) = c.
$$

We still want to analyze how changes in the independet variables affect the dependent variable.

```{admonition} Fact (Implicit function theorem)
:class: important

Suppose that $G\left(x_{1}, x_{2}, \cdots, x_{n}, y\right)$ is a function that is at least once continuously differentiable around the point $\left(x_{1}^{*}, x_{2}^{*}, \cdots, x_{n}^{*}, y^{*}\right)$. Suppose also that

$$
G\left(x_{1}^{*}, x_{2}^{*}, \cdots, x_{n}^{*}, y^{*}\right)=c \text { for some constant } c
$$

and that

$$
\frac{\partial G}{\partial y}\left(x_{1}^{*}, x_{2}^{*}, \cdots, x_{n}^{*}, y^{*}\right) \neq 0
$$


Under these conditions, there is a function $y\left(x_{1}, x_{2}, \cdots, x_{n}\right)$ defined on some open ball $B$ around the point $\left(x_{1}^{*}, x_{2}^{*}, \cdots, x_{n}^{*}\right)$ that is at least once continuously differentiable such that:

$$
G\left(x_{1}, x_{2}, \cdots, x_{n}, y\left(x_{1}, x_{2}, \cdots, x_{n}\right)\right)=c \\
\text { for all }\left(x_{1}, x_{2}, \cdots, x_{n}\right) \in B
$$

$$
y^{*}=y\left(x_{1}^{*}, x_{2}^{*}, \cdots, x_{n}^{*}\right)
$$

$$
\frac{\partial y}{\partial x_{i}}\left(x_{1}^{*}, x_{2}^{*}, \cdots, x_{n}^{*}\right)=-\left(\frac{\frac{\partial G}{\partial x_{i}}\left(x_{1}^{*}, x_{2}^{*}, \cdots, x_{n}^{*}, y^{*}\right)}{\frac{\partial G}{\partial y}\left(x_{1}^{*}, x_{2}^{*}, \cdots, x_{n}^{*}, y^{*}\right)}\right) \\
\text { for each } i \in\{1,2, \cdots, n\}
$$

```

### Some applications of implicit functions

Some potential applications of the implicit function theorem include the following:
- The slope of an indifference curve
- The slope of an iso-expenditure ("budget") line
- The slope of an isoquant
- The slope of an isocost

Before discussing these examples, we will consider the related concepts of level sets, upper contour sets and lower contour sets.


## Level sets and contour sets

Consider a function $f: X \rightarrow Y$, where $X \subseteq \mathbb{R}^{L}$ and $Y \subseteq \mathbb{R}$.

- A **level set** for the function $f$ defined with respect to a point in the domain $\widehat{x} \in X$ is defined to be

$$
f_{\widehat{x}}^{0}=\{x \in X: f(x)=f(\widehat{x})\} .
$$

- A **weak upper contour** set for the function $f$ defined with respect to a point in the domain $\widehat{x} \in X$ is defined to be

$$
f_{\widehat{x}}^{+}=\{x \in X: f(x) \geq f(\widehat{x})\} .
$$

- A **strong upper contour set** for the function $f$ defined with respect to a point in the domain $\widehat{X} \in X$ is defined to be

$$
f_{\widehat{x}}^{++}=\{x \in X: f(x)>f(\widehat{x})\} .
$$

- A **weak lower contour set** for the function $f$ defined with respect to a point in the domain $\widehat{X} \in X$ is defined to be

$$
f_{\widehat{x}}^{-}=\{x \in X: f(x) \leq f(\widehat{x})\} .
$$

- A **strong lower contour set** for the function $f$ defined with respect to a point in the domain $\widehat{X} \in X$ is defined to be

$$
f_{\widehat{x}}^{--}=\{x \in X: f(x)<f(\widehat{x})\} .
$$


### The slope of an indifference curve

Suppose that $U: \mathbb{R}_{+}^{L} \rightarrow \mathbb{R}$ is a utility function.

The level sets for a utility function are known as indifference curves. The indifference curve that passes through consumption bundle $\widehat{x} \in \mathbb{R}_{+}^{L}$ is defined to be

$$
U_{\widehat{x}}^{0}=\left\{x \in \mathbb{R}_{+}^{L}: U(x)=U(\widehat{x})\right\} .
$$

The (weak) upper contour sets for a utility function could be called consumption requirement sets. The consumption requirement set that is associated with the reference consumption bundle $\widehat{x} \in \mathbb{R}_{+}^{L}$ is defined to be

$$
U_{\widehat{x}}^{+}=\left\{x \in \mathbb{R}_{+}^{L}: U(x) \geq U(\widehat{x})\right\}
$$


Note that we could also define the level set and the (weak) upper contour set for a utility function in terms of a reference utility level, $\bar{U}$. I will leave the modification of the definitions for the case in which a reference utility level is employed as an exercise for you to attempt.
Note that any point $x \in \mathbb{R}_{+}^{L}$ that belongs to an indifference curve must yield the same level of utility.
This means that the change in utility around any indifference curve is zero.
In other words, $d U=0$ along an indifference curve.


Suppose that $L=2$. We have

$$
d U=\left(\frac{\partial U}{\partial x_{1}}\right) d x_{1}+\left(\frac{\partial U}{\partial x_{2}}\right) d x_{2}
$$

Along any indifference curve, we must have

$$
d U=\left(\frac{\partial U}{\partial x_{1}}\right) d x_{1}+\left(\frac{\partial U}{\partial x_{2}}\right) d x_{2}=0
$$

This can be rearranged to obtain

$$
\left.\frac{d x_{2}}{d x_{1}}\right|_{d U=0}=\frac{-\left(\frac{\partial U}{\partial x_{1}}\right)}{\left(\frac{\partial U}{\partial x_{2}}\right)}= -MRS_{12}(x)
$$

which is the formula for the slope of an indifference curve when $U: \mathbb{R}_{+}^{2} \rightarrow \mathbb{R}$.


### The slope of a budget line

A consumer's expenditure is given by the linear function $E: \mathbb{R}_{+}^{L} \rightarrow \mathbb{R}$ that is defined by

$$
E(x)=p^{T} x=\sum_{l=1}^{L} p_{l} x_{l}
$$

where $p \in \mathbb{R}_{++}^{L}$, so that $p_{l}>0$ for all $l \in\{1,2, \cdots, L\}$.

We will refer to this as the budget function, because the term "expenditure function" has a specific meaning in microeconomics that differs somewhat from this function.


The level sets for a budget function are known budget lines (or, if you prefer, budget hyper-planes).

The budget line that passes through consumption bundle $\omega \in \mathbb{R}_{+}^{L}$ is defined to be

$$
B_{\omega}^{0}(p, \boldsymbol{\omega})=\left\{x \in \mathbb{R}_{+}^{L}: E(x)=E(\boldsymbol{\omega})\right\} .
$$

In this case, we might think of $\omega \in \mathbb{R}_{+}^{L}$ as an endowment bundle.

The budget line that is consistent with an exogenous money income equal to $M \in \mathbb{R}_{+}$ is defined to be

$$
B_{M}^{0}(p, M)=\left\{x \in \mathbb{R}_{+}^{L}: E(x)=M\right\}
$$


The (weak) lower contour sets for a budget function are known budget sets. The budget set that is associated with the endowment bundle $\omega \in \mathbb{R}_{+}^{L}$ is defined to be

$$
B_{\omega}^{-}(p, \mathfrak{\omega})=\left\{x \in \mathbb{R}_{+}^{L}: E(x) \leq E(\mathfrak{\omega})\right\}
$$

The (weak) lower contour sets for a budget function are known budget sets. The budget set that is associated with an exogenous money income equal to $M \in \mathbb{R}_{+}$ is defined to be

$$
B_{M}^{-}(p, M)=\left\{x \in \mathbb{R}_{+}^{L}: E(x) \leq M\right\}
$$


Note that any point $x \in \mathbb{R}_{+}^{L}$ that belongs to a budget line must require the same level of expenditure. This means that the change in expenditure along any budget line is zero. In other words, $d E=0$ along a budget line.

Suppose that $L=2$. We have

$$
\begin{aligned}
d E &= \left(\frac{\partial E}{\partial x_{1}}\right) d x_{1}+\left(\frac{\partial E}{\partial x_{2}}\right) d x_{2} \\
&= \left(\frac{\partial\left(p_{1} x_{1}+p_{2} x_{2}\right)}{\partial x_{1}}\right) d x_{1} 
 +\left(\frac{\partial\left(p_{1} x_{1}+p_{2} x_{2}\right)}{\partial x_{2}}\right) d x_{2} \\
&= p_{1} d x_{1}+p_{2} d x_{2}
\end{aligned}
$$



Along any budget line, we must have

$$
d E=p_{1} d x_{1}+p_{2} d x_{2}=0
$$


This can be rearranged to obtain

$$
\left.\frac{d x_{2}}{d x_{1}}\right|_{d E=0}=\frac{-p_{1}}{p_{2}}
$$

which is the formula for the slope of a budget line when the consumption set is given by $\mathbb{R}_{+}^{2}$.

### The slope of an isoquant

Suppose that $F: \mathbb{R}_{+}^{K} \rightarrow \mathbb{R}_{+}$ is a single-product production function.

The level sets for a production function are known as isoquants. The isoquant that is consistent with $y \in \mathbb{R}_{+}$ units of output being produced is defined to be

$$
F_{y}^{0}=\left\{x \in \mathbb{R}_{+}^{K}: F(x)=y\right\}
$$

The (weak) upper contour sets for a production function are known as input requirement sets. The input requirement set that is associated with $y \in \mathbb{R}_{+}$ units of output being produced is defined to be

$$
F_{y}^{+}=\left\{x \in \mathbb{R}_{+}^{K}: F(x) \geq y\right\}
$$


Note that we could also define the level set and the (weak) upper contour set for a production function in terms of a reference input bundle, $\widehat{x}$. I will leave the modification of the definitions for the case in which a reference input bundle is employed as an exercise for you to attempt.
Note that any point $x \in \mathbb{R}_{+}^{K}$ that belongs to an isoquant must yield the same level of output.
This means that the change in output around any isoquant is zero.
In other words, $d F=0$ along an isoquant.


Suppose that $K=2$. We have

$$
d F=\left(\frac{\partial F}{\partial x_{1}}\right) d x_{1}+\left(\frac{\partial F}{\partial x_{2}}\right) d x_{2}
$$

Along any isoquant, we must have

$$
d F=\left(\frac{\partial F}{\partial x_{1}}\right) d x_{1}+\left(\frac{\partial F}{\partial x_{2}}\right) d x_{2}=0
$$

This can be rearranged to obtain

$$
\left.\frac{d x_{2}}{d x_{1}}\right|_{d F=0}=\frac{-\left(\frac{\partial F}{\partial x_{1}}\right)}{\left(\frac{\partial F}{\partial x_{2}}\right)}=-\operatorname{MRTS}_{12}(x)
$$

which is the formula for the slope of an isoquant when $F: \mathbb{R}_{+}^{2} \rightarrow \mathbb{R}_{+}$.



### The slope of an isocost

A firm's expenditure on inputs is given by the linear function $E: \mathbb{R}_{+}^{K} \rightarrow \mathbb{R}$ that is defined by

$$
E(x)=w^{T} x=\sum_{k=1}^{K} w_{k} x_{k}
$$

where $w \in \mathbb{R}_{++}^{K}$ is the input price vector.

Note that $w \in \mathbb{R}_{++}^{K}$ means that $w_{k}>0$ for all $k \in\{1,2, \cdots, K\}$.

We will refer to this as the budget function, because the term "cost function" has a specific meaning in microeconomics that differs somewhat from this function.



The level sets for a firm's budget function are known as isocosts.

The isocost line that passes through input bundle $\widehat{x} \in \mathbb{R}_{+}^{K}$ is defined to be

$$
B_{\widehat{x}}^{0}(w, \widehat{x})=\left\{x \in \mathbb{R}_{+}^{K}: E(x)=E(\widehat{x})\right\} .
$$

In this case, we might think of $\omega \in \mathbb{R}_{+}^{L}$ as an endowment bundle.

The isocost line that is consistent with a particular level of expenditure on inputs equal to $C \in \mathbb{R}_{+}$ is defined to be

$$
B_{C}^{0}(p, M)=\left\{x \in \mathbb{R}_{+}^{K}: E(x)=C\right\} .
$$


Note that any point $x \in \mathbb{R}_{+}^{K}$ that belongs to an isocost line must involve the same level of expenditure on inputs.
This means that the change in expenditure on inputs along any isocost line is zero.
In other words, $d E=0$ along an isocost line.

Suppose that $K=2$. We have

$$
\begin{aligned}
d E &= \left(\frac{\partial E}{\partial x_{1}}\right) d x_{1}+\left(\frac{\partial E}{\partial x_{2}}\right) d x_{2} \\
&= \left(\frac{\partial\left(w_{1} x_{1}+w_{2} x_{2}\right)}{\partial x_{1}}\right) d x_{1} 
 +\left(\frac{\partial\left(w_{1} x_{1}+w_{2} x_{2}\right)}{\partial x_{2}}\right) d x_{2} \\
&= w_{1} d x_{1}+w_{2} d x_{2}
\end{aligned}
$$


Along any isocost line, we must have

$$
d E=w_{1} d x_{1}+w_{2} d x_{2}=0
$$

This can be rearranged to obtain

$$
\left.\frac{d x_{2}}{d x_{1}}\right|_{d E=0}=\frac{-w_{1}}{w_{2}}
$$

which is the formula for the slope of an isocost line for a firm with a production technology that involves two inputs.


## Total differentials

Consider a function $f: S \longrightarrow \mathbb{R}$, where $S \subseteq \mathbb{R}^{n}$ is an open set. This function can be written as $f\left(x_{1}, x_{2}, \cdots, x_{n}\right)$. Suppose that this function is at least twice continuously differentiable with respect to all of its arguments.

Suppose that we want to consider the impact of a small change in each of the independent variables on the value of the function.

Imagine that the initial values of the independent variables are

$$
x=\left(x_{1}, x_{2}, \cdots, x_{n}\right)
$$

Following the change, the new values of the independent variables are

$$
x+d x=\left(x_{1}+d x_{1}, x_{2}+d x_{2}, \cdots, x_{n}+d x_{n}\right)
$$

Note that the vector of changes in the independent variables is

$$
\begin{aligned}
d x &= x+d x-x \\
&= \left(x_{1}+d x_{1}, x_{2}+d x_{2}, \cdots, x_{n}+d x_{n}\right)
-\left(x_{1}, x_{2}, \cdots, x_{n}\right) \\
&=  \left(d x_{1}, d x_{2}, \cdots, d x_{n}\right) .
\end{aligned}
$$

The actual change in the value of the function that is induced by these changes in the independent variables is

$$
d f=f(x+d x)-f(x)
$$

When the function is non-linear, this actual change can be rather complicated to calculate explicitly.


As such, we will often employ a first-order (or linear) differential approximation for $d f$. This approximation is known as the **(first-order) total differential** of the function. It is given by

$$
d f \approx \sum_{i=1}^{n}\left(\frac{\partial f}{\partial x_{i}}\right) d x_{i}
$$

If the function is twice continuously differentiable in all of its arguments and the change in each of the independent variables is sufficiently small, then this approximation for $d f$ will be reasonably accurate.

## The inverse function theorem

This is Theorem 15.9 in {cite:ps}`simon1994` (p. 367).

```{admonition} Fact
:class: important

Consider a function of the form $f: \mathbb{R}^{n} \longrightarrow \mathbb{R}^{n}$.

Suppose that:
- (a) $f: \mathbb{R}^{n} \longrightarrow \mathbb{R}^{n}$ is at least once continuously differentiable;
- (b) $f\left(x^{*}\right)=y^{*}$; and
- (c) The Jacobian matrix $D_{x} f$ is non-singular at the point $x^{*}$.

If this is the case, then:
- (i) There exists an open ball $B_{r}\left(x^{*}\right)$ around the point $x^{*}$, and an open set $V$ around the point $y^{*}$, such that $f: B_{r}\left(x^{*}\right) \longrightarrow V$ is both one-to-one and onto;
- (ii) The inverse map $f^{-1}: V \longrightarrow B_{r}\left(x^{*}\right)$ is at least once continuously differentiable; and
- (iii) The derivative of the inverse function at the point $x^{*}$ is equal to the inverse of the derivative function at the point $x^{*}$ (that is $\left(D_{x} f^{-1}\right)\left(f\left(x^{*}\right)=\left(D_{x} f\left(x^{*}\right)\right)^{-1}\right)$.

```

### An elasticity application of the inverse function theorem

Consider a function of the form $f: S \longrightarrow \mathbb{R}$, where $S \subseteq \mathbb{R}^{n}$ is an open set.
Suppose that this function is at least once continuously differentiable in all of its arguments.

The elasticity of $f$ with respect to the variable $x_{i}$ at the point $(x, f(x))$ is given by the formula

$$
\varepsilon_{i}^{f}=\left(\frac{x_{i}}{f(x)}\right)\left(\frac{\partial f}{\partial x_{i}}\right)
$$

Another formula for the elasticity of $f$ with respect to the variable $x_{i}$ at the point $(x, f(x))$ that is sometimes useful is

$$
\varepsilon_{i}^{f}=\frac{\partial \ln (f(x))}{\partial \ln \left(x_{i}\right)}
$$

We will use the chain rule of differentiation and the inverse function theorem to show that these two formulas are equivalent. Note that

$$
\frac{\partial \ln (f(x))}{\partial \ln \left(x_{i}\right)}=\left(\frac{\partial \ln (f(x))}{\partial f(x)}\right)\left(\frac{\partial f(x)}{\partial x_{i}}\right)\left(\frac{\partial x_{i}}{\partial \ln \left(x_{i}\right)}\right)
$$

from the chain rule of differentiation.

We know from the inverse function theorem that

$$
\left(\frac{\partial x_{i}}{\partial \ln \left(x_{i}\right)}\right)=\frac{1}{\left(\frac{\partial \ln \left(x_{i}\right)}{\partial x_{i}}\right)}
$$

Thus we have

$$
\frac{\partial \ln (f(x))}{\partial \ln \left(x_{i}\right)}=\left(\frac{\partial \ln (f(x))}{\partial f(x)}\right)\left(\frac{\partial f(x)}{\partial x_{i}}\right)\left(\frac{1}{\left(\frac{\partial \ln \left(x_{i}\right)}{\partial x_{i}}\right)}\right)
$$

Note that $\frac{\partial \ln (f(x))}{\partial f(x)}=\frac{1}{f(x)}$ and $\frac{\partial \ln \left(x_{i}\right)}{\partial x_{i}}=\frac{1}{x_{i}}$. This means that

$$
\frac{\partial \ln (f(x))}{\partial \ln \left(x_{i}\right)}=\left(\frac{1}{f(x)}\right)\left(\frac{\partial f(x)}{\partial x_{i}}\right)\left(\frac{1}{\frac{1}{x_{i}}}\right)=\left(\frac{1}{f(x)}\right)\left(\frac{\partial f(x)}{\partial x_{i}}\right)\left(x_{i}\right)
$$

This can be rearranged to obtain

$$
\frac{\partial \ln (f(x))}{\partial \ln \left(x_{i}\right)}=\left(\frac{x_{i}}{f(x)}\right)\left(\frac{\partial f}{\partial x_{i}}\right) .
$$


## Homogeneous functions

Consider a function $f: S \longrightarrow \mathbb{R}$, where $S \subseteq \mathbb{R}^{n}$.

This function can be written as $f\left(x_{1}, x_{2}, \cdots, x_{n}\right)$.

Let $\lambda>0$ be a positive real number.

```{admonition} Definition
:class: caution

The function $f\left(x_{1}, x_{2}, \cdots, x_{n}\right)$ is said to be **homogeneous of degree $r$** if

$$
f\left(\lambda x_{1}, \lambda x_{2}, \cdots, \lambda x_{n}\right)=\lambda^{r} f\left(x_{1}, x_{2}, \cdots, x_{n}\right)
$$

for all $\left(x_{1}, x_{2}, \cdots, x_{n}\right) \in S$ and all $\lambda>0$.

```

```{admonition} Definition
:class: caution

A function that is homogeneous of degree one is said to be **linearly homogeneous**.

```


Homogeneity is a cardinal property, not an ordinal one.
This means that homogeneity will not necessarily be preserved under a strictly increasing transformation.
An ordinal property that is somewhat similar to homogeneity is that of homotheticity.
A discussion of homotheticity can be found in {cite:ps}`simon1994` (pp. 483 and 500-504).


## Euler's theorem

```{admonition} Fact
:class: important

Suppose that the function $f\left(x_{1}, x_{2}, \cdots, x_{n}\right)$ is homogeneous of degree $r$. In this case we have

$$
\sum_{i=1}^{n} x_{i}\left(\frac{\partial f}{\partial x_{i}}\right)=r f\left(x_{1}, x_{2}, \cdots, x_{n}\right) .
$$

```

This result is known as **Euler's theorem**.

It is straightforward to explicitly derive this result from the definition of homogeneity of degree $r$. The following proof is based on the one in {cite:ps}`haeussler1987` (p. 723).

Since the function $f\left(x_{1}, x_{2}, \cdots, x_{n}\right)$ is homogeneous of degree $r$, we know that

$$
f\left(\lambda x_{1}, \lambda x_{2}, \cdots, \lambda x_{n}\right)=\lambda^{r} f\left(x_{1}, x_{2}, \cdots, x_{n}\right)
$$

for any choice of $\lambda>0$.

Consider the left-hand side of this definition first. Let $z_{i}=\lambda x_{i}$ for all $i \in\{1,2, \cdots, n\}$. Totally differentiating

$$
f\left(\lambda x_{1}, \lambda x_{2}, \cdots, \lambda x_{n}\right)=f\left(z_{1}, z_{2}, \cdots, z_{n}\right)
$$

yields

$$
d f=\sum_{i=1}^{n}\left(\frac{\partial f}{\partial z_{i}}\right) d z_{i}
$$

Dividing both sides of this total differential by $d \lambda \neq 0$ yields

$$
\frac{d f}{d \lambda}=\sum_{i=1}^{n}\left(\frac{\partial f}{\partial z_{i}}\right)\left(\frac{d z_{i}}{d \lambda}\right)
$$


Suppose that we hold all of the $x_{i}$ variables constant and only allow $\lambda$ to vary. This means that $d x_{i}=0$ for all $i \in\{1,2, \cdots, n\}$ and $d \lambda \neq 0$. This yields

$$
\left.\frac{d f}{d \lambda}\right|_{d x_{i}=0 \text { for all } i}=\sum_{i=1}^{n}\left(\frac{\partial f}{\partial z_{i}}\right)\left(\left.\frac{d z_{i}}{d \lambda}\right|_{d x_{i}=0 \text { for all } i}\right) .
$$

Note that

$$
\left.\frac{d f}{d \lambda}\right|_{d x_{i}=0 \text { for all } i}=\frac{\partial f}{\partial \lambda}
$$

and

$$
\left.\frac{d z_{i}}{d \lambda}\right|_{d x_{i}=0 \text { for all } i}=\frac{\partial z_{i}}{\partial \lambda}
$$


Thus we have

$$
\frac{\partial f}{\partial \lambda}=\sum_{i=1}^{n}\left(\frac{\partial f}{\partial z_{i}}\right)\left(\frac{\partial z_{i}}{\partial \lambda}\right)
$$

Note that

$$
\frac{\partial z_{i}}{\partial \lambda}=\frac{\partial\left(\lambda x_{i}\right)}{\partial \lambda}=x_{i}
$$

for all $i \in\{1,2, \cdots, n\}$.

Thus we know that the partial derivative of

$$
f\left(\lambda x_{1}, \lambda x_{2}, \cdots, \lambda x_{n}\right)
$$

with respect to $\lambda$ is

$$
\frac{\partial f\left(\lambda x_{1}, \lambda x_{2}, \cdots, \lambda x_{n}\right)}{\partial \lambda}=\sum_{i=1}^{n}\left(\frac{\partial f}{\partial z_{i}}\right) x_{i}
$$

where $z_{i}=\lambda x_{i}$ for all $i \in\{1,2, \cdots, n\}$.


Now consider the right hand-side of the following definition for a function that is homogeneous of degree $r$ :

$$
f\left(\lambda x_{1}, \lambda x_{2}, \cdots, \lambda x_{n}\right)=\lambda^{r} f\left(x_{1}, x_{2}, \cdots, x_{n}\right)
$$

for any choice of $\lambda>0$.

Note that $\lambda$ does not appear in the term $\left(x_{1}, x_{2}, \cdots, x_{n}\right)$. As such, the partial derivative of $\lambda^{r} f\left(x_{1}, x_{2}, \cdots, x_{n}\right)$ with respect to $\lambda$ is

$$
\frac{\partial \lambda^{r} f\left(x_{1}, x_{2}, \cdots, x_{n}\right)}{\partial \lambda}=r \lambda^{r-1} f\left(x_{1}, x_{2}, \cdots, x_{n}\right) .
$$


Thus we have

$$
\begin{aligned}
f\left(\lambda x_{1}, \lambda x_{2}, \cdots, \lambda x_{n}\right) &= \lambda^{r} f\left(x_{1}, x_{2}, \cdots, x_{n}\right) \\[5pt]
\Longleftrightarrow \\[5pt]
\frac{\partial f\left(\lambda x_{1}, \lambda x_{2}, \cdots, \lambda x_{n}\right)}{\partial \lambda} &=\frac{\partial \lambda^{r} f\left(x_{1}, x_{2}, \cdots, x_{n}\right)}{\partial \lambda} \\[5pt]
\Longleftrightarrow \\[5pt]
\sum_{i=1}^{n}\left(\frac{\partial f}{\partial z_{i}}\right) x_{i} &= r \lambda^{r-1} f\left(x_{1}, x_{2}, \cdots, x_{n}\right) .
\end{aligned}
$$


Note that when $\lambda=1$ we have $z_{i}=1 x_{i}=x_{i}$ for all $i \in\{1,2, \cdots, n\}$. This means that

$$
\left(\frac{\partial f}{\partial z_{i}}\right)=\left(\frac{\partial f}{\partial x_{i}}\right)
$$

for all $i \in\{1,2, \cdots, n\}$ when $\lambda=1$.

Note also that when $\lambda=1$ we have

$$
\lambda^{r-1}=1^{r-1}=1
$$

Now suppose that we evaluate both sides of this last equation at the point $\lambda=1$. This yields

$$
\sum_{i=1}^{n}\left(\frac{\partial f}{\partial x_{i}}\right) x_{i}=r f\left(x_{1}, x_{2}, \cdots, x_{n}\right)
$$

which is the result from Euler's theorem.


### Applications of homogeneity

Some applications of homogeneity include the following:
- Returns to scale for production technologies in general.
- Returns to scale for Cobb-Douglas production technologies.
- Euler aggregation for a Marshallian demand function.
- Product exhaustion under perfect competition and constant returns to scale.


### Returns to scale

Suppose that an $n$ input and one output production technology can be represented by a production function of the form

$$
Q=f\left(L_{1}, L_{2}, \cdots, L_{n}\right) .
$$

What happens if we increase all of the inputs by the same proportion?

Specifically, suppose that we move to an input bundle of the form $\left(\lambda L_{1}, \lambda L_{2}, \cdots, \lambda L_{n}\right)$, where $\lambda>0$.


#### Decreasing returns to scale

The production technology is said to display **decreasing returns to scale** if this increase in all of the inputs induces a less than proportionate change in the amount of output that can be produced.

In other words, production technology is said to display decreasing returns to scale if

$$
f\left(\lambda L_{1}, \lambda L_{2}, \cdots, \lambda L_{n}\right)<\lambda Q
$$

which is equivalent to

$$
f\left(\lambda L_{1}, \lambda L_{2}, \cdots, \lambda L_{n}\right)<\lambda f\left(L_{1}, L_{2}, \cdots, L_{n}\right) .
$$

Thus the production function for a production technology that displays decreasing returns to scale is either homogeneous of degree less than one or it is not homogeneous.

```{admonition} Note

A simple replication argument would suggest that decreasing returns to scale do not make any sense.

Studies that find decreasing returns to scale are probably really finding diminishing marginal products.

There is probably some unobserved (or imprecisely observed) input that is implicitly being held fixed or, at least, not varying in the same proportion as all of the other inputs.
```


#### Constant returns to scale
The production technology is said to display **constant returns to scale** if this increase in all of the inputs induces a proportionate change in the amount of output that can be produced.

In other words, production technology is said to display constant returns to scale if

$$
f\left(\lambda L_{1}, \lambda L_{2}, \cdots, \lambda L_{n}\right)=\lambda Q
$$

which is equivalent to

$$
f\left(\lambda L_{1}, \lambda L_{2}, \cdots, \lambda L_{n}\right)=\lambda f\left(L_{1}, L_{2}, \cdots, L_{n}\right) .
$$

Thus the production function for a production technology that displays constant returns to scale will be homogeneous of degree one. (Homogeneity of degree one is sometimes referred to as linear homogeneity.)

```{admonition} Note

Constant returns to scale production technologies are employed in the standard versions of the neoclassical model of economic growth. This model is often referred to as the Solow-Swan model of economic growth, because one of the seminal papers on this model was written by Robert Solow and the other was written by Trevor Swan. Note that the late Trevor Swan was an Australian economist who worked at the Australian National University.

The relevant references are:
- Solow, RM (1956), "A contribution to the theory of economic growth", The Quarterly Journal of Economics 70(1), February, pp. 65-94; and
- Swan, TW (1956), "Economic growth and capital accumulation", The Economic Record 32, November, pp. 334-361.
```

#### Increasing returns to scale
The production technology is said to display **increasing returns to scale** if this increase in all of the inputs induces a more than proportionate change in the amount of output that can be produced.

In other words, production technology is said to display increasing returns to scale if

$$
f\left(\lambda L_{1}, \lambda L_{2}, \cdots, \lambda L_{n}\right)>\lambda Q
$$

which is equivalent to

$$
f\left(\lambda L_{1}, \lambda L_{2}, \cdots, \lambda L_{n}\right)>\lambda f\left(L_{1}, L_{2}, \cdots, L_{n}\right) .
$$

Thus the production function for a production technology that displays increasing returns to scale is either homogeneous of degree more than one or it is not homogeneous.


```{admonition} Note

The returns to scale displayed by some production technologies might vary with input vector.  In such cases, the production technology will not necessarily display either constant returns to scale or increasing returns to scale over the entire set of possible values for the input vector.
```


### Cobb-Douglas production functions

Suppose that an two input and one output production technology can be represented by a production function of the form

$$
Q=f(L, K)=A L^{\alpha} K^{\beta} .
$$

This type of production function is known as a Cobb-Douglas production function.


Suppose that $\lambda>0$. Note that

$$
\begin{aligned}
f(\lambda L, \lambda K) & =A(\lambda L)^{\alpha}(\lambda K)^{\beta} \\
& =A \lambda^{\alpha} L^{\alpha} \lambda^{\beta} K^{\beta} \\
& =\lambda^{\alpha+\beta} A L^{\alpha} K^{\beta} \\
& =\lambda^{\alpha+\beta} f(L, K)
\end{aligned}
$$

Thus we know that the Cobb-Douglas production function is homogeneous of degree $(\alpha+\beta)$.

- If $(\alpha+\beta)<1$, then the Cobb-Douglas production function displays decreasing returns to scale;
- If $(\alpha+\beta)=1$, then the Cobb-Douglas production function displays constant returns to scale; and
- If $(\alpha+\beta)>1$, then the Cobb-Douglas production function displays increasing returns to scale.


### Euler aggregation

Suppose that a consumer's Marshallian demand for commodity $k$ is given by the function

$$
\begin{aligned}
Q_{k} & =x_{k}\left(p_{1}, p_{2}, \cdots, p_{n}, y\right) \\
& =x_{k}(p, y) .
\end{aligned}
$$

It can be shown that under certain circumstance, Marshallian demand functions are homogeneous of degree zero.

We will not provide a formal proof of this proposition here. However, the result is fairly intuitive. If all prices and income increase by the same proportion, then the budget constraint for the consumer does not change. If his or her preferences remain the same, then the fact that the budget constraint has not changed would suggest that the choice problem that faces the consumer has not changed in any real sense. As such, the consumer's optimal consumption bundle should not have changed either.

If Marshallian demand functions are homogeneous of degree zero, then the Marshallian demand for commodity $k$ will be homogeneous of degree zero.
In such circumstances, we know from Euler's theorem that

$$
\begin{aligned}
& y\left(\frac{\partial x_{k}(p, y)}{\partial y}\right)+\sum_{i=1}^{n} p_{i}\left(\frac{\partial x_{k}(p, y)}{\partial p_{i}}\right) \\
= & (0) x_{k}\left(p_{1}, p_{2}, \cdots, p_{n}, y\right) .
\end{aligned}
$$

This can be simplified to obtain

$$
y\left(\frac{\partial x_{k}(p, y)}{\partial y}\right)+\sum_{i=1}^{n} p_{i}\left(\frac{\partial x_{k}(p, y)}{\partial p_{i}}\right)=0
$$


This can be rearranged to obtain

$$
\sum_{i=1}^{n} p_{i}\left(\frac{\partial x_{k}(p, y)}{\partial p_{i}}\right)=-y\left(\frac{\partial x_{k}(p, y)}{\partial y}\right)
$$

Upon dividing both sides of this equation by $x_{k}(p, y)$, we obtain

$$
\begin{aligned}
& \sum_{i=1}^{n}\left(\frac{p_{i}}{x_{k}(p, y)}\right)\left(\frac{\partial x_{k}(p, y)}{\partial p_{i}}\right) \\
= & -\left(\frac{y}{x_{k}(p, y)}\right)\left(\frac{\partial x_{k}(p, y)}{\partial y}\right) .
\end{aligned}
$$

Thus we have

$$
\sum_{i=1}^{n} \varepsilon_{i}^{k}=-\varepsilon_{y}^{k}
$$

where

$$
\varepsilon_{i}^{k}=\left(\frac{p_{i}}{x_{k}(p, y)}\right)\left(\frac{\partial x_{k}(p, y)}{\partial p_{i}}\right)
$$

is the elasticity of demand for commodity $k$ with respect to the price of good $l$ and

$$
\varepsilon_{y}^{k}=\left(\frac{y}{x_{k}(p, y)}\right)\left(\frac{\partial x_{k}(p, y)}{\partial y}\right)
$$

is the income elasticity of demand for commodity $k$.

As far as I am aware, this well known result does not have a name. But it could be referred to as Euler aggregation, because it makes use of Euler's theorem.


### Product exhaustion

Consider a profit-maximising firm that has a single output $(Q)$ and two inputs $(L$ and $K$ ) production technology that displayys constant returns to scale. This production technology can be represented by a production function of the form

$$
Q=f(L, K)
$$

Suppose that this firm is a price-taker in both the ouput market and all input markets.
Constant returns to scale imply that the production function is homogeneous of degree one. Thus we know from Euler's theorem that

$$
\left(\frac{\partial f}{\partial L}\right) L+\left(\frac{\partial f}{\partial K}\right) K=f(L, K)
$$


Recall that the first-order conditions for profit maximisation by a firm with these characteristics are

$$
\left(\frac{\partial f}{\partial L}\right)=\frac{w}{p}
$$

and

$$
\left(\frac{\partial f}{\partial K}\right)=\frac{r}{p}
$$

where $p$ is the output price, $w$ is the input price for labour $(L)$ and $r$ is the input price for capital $(K)$.

Upon substituting these FOCs into Equation (1), we obtain

$$
\left(\frac{w}{p}\right) L+\left(\frac{r}{p}\right) K=f(L, K) .
$$

This can be rearranged to obtain

$$
w L+r K=p f(L, K) .
$$

In other words, the firm's revenue from sales of its output will be exactly equal to the firm's expenditure on inputs. This result, which implies zero profits for a perfectly competitive firm with a constant returns to scale production technology, is known as product exhaustion.

(Note that profit here means economic profit, not accounting profit.)

